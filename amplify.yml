version: 1
applications:
  - appRoot: .
    backend:
      phases:
        preBuild:
          commands:
            # Debug environment
            - pwd
            - ls -la
            - echo "Node and npm versions:"
            - node --version
            - npm --version
            # Install all dependencies in one step
            - npm ci
            - echo "Verifying critical dependencies:"
            - npm list webpack webpack-cli ts-loader typescript || true
            - echo "Webpack version:"
            - npx webpack --version
            - echo "Webpack config:"
            - cat webpack.config.js
        build:
          commands:
            - npx webpack --config webpack.config.js
      artifacts:
        baseDirectory: dist
        files:
          - '**/*'
    frontend:
      phases:
        preBuild:
          commands:
            - echo "No frontend build needed"
        build:
          commands:
            - echo "No frontend build needed"
      artifacts:
        baseDirectory: /
        files:
          - '**/*' 